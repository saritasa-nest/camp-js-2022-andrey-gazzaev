<mat-form-field appearance="fill">
  <mat-label>{{ selectorLabel }}</mat-label>
  <mat-select [formControl]="formControlEntities" multiple>
    <mat-option>
      <ngx-mat-select-search
        [placeholderLabel]="'Find ' + entitiesName + '...'"
        [formControl]="formControlSearchEntity"
      ></ngx-mat-select-search>
    </mat-option>

    <ng-container *ngIf="entities.length === 0">
      <button mat-stroked-button type="button" (click)="onCreateEntity()">
        Create {{ entitiesName }}
      </button>
    </ng-container>

    <div
      class="option"
      *ngFor="let entity of entities; trackBy: trackItemEntity"
    >
      <mat-option [value]="entity.id">
        <span>{{ entity.name }}</span>
      </mat-option>
      <button
        mat-button
        type="button"
        click-stop-propagation
        (click)="onRemoveEntity(entity.id)"
      >
        <mat-icon>delete</mat-icon>
      </button>
    </div>

    <ng-container *ngIf="isStringEmpty(this.formControlSearchEntity.value)">
      <button mat-stroked-button type="button" (click)="onMoreEntities()">
        Add more {{ entitiesName }}
      </button>
    </ng-container>
  </mat-select>
</mat-form-field>
